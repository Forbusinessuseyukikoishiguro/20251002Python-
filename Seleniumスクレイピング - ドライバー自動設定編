# ã€Pythonå…ˆç”Ÿã®è§£èª¬ã€‘Seleniumã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° - ãƒ‰ãƒ©ã‚¤ãƒãƒ¼è‡ªå‹•è¨­å®šç·¨

æ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®çš†ã•ã‚“ã€ã“ã‚“ã«ã¡ã¯!ä»Šæ—¥ã¯Seleniumã§ChromeDriverã‚’**æ‰‹å‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸è¦**ã§ä½¿ã†æ–¹æ³•ã‚’æ•™ãˆã¾ã™!

## 1. å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# Seleniumæœ¬ä½“ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install selenium

# ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’è‡ªå‹•ç®¡ç†ã—ã¦ãã‚Œã‚‹ä¾¿åˆ©ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª
pip install webdriver-manager
```

**ãªãœwebdriver-managerãŒä¾¿åˆ©?**
- ChromeDriverã‚’è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è‡ªå‹•ã§åˆã‚ã›ã¦ãã‚Œã‚‹
- ãƒ‘ã‚¹ã®è¨­å®šä¸è¦

## 2. åŸºæœ¬çš„ãªã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰(å®Œå…¨ç‰ˆ)

```python
# seleniumã‹ã‚‰webdriverã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ(ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ“ä½œã™ã‚‹ãƒ„ãƒ¼ãƒ«)
from selenium import webdriver

# Chromeã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
from selenium.webdriver.chrome.options import Options

# Chromeã®ã‚µãƒ¼ãƒ“ã‚¹è¨­å®šã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
from selenium.webdriver.chrome.service import Service

# webdriver-managerã‹ã‚‰ChromeDriverManagerã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ(è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨)
from webdriver_manager.chrome import ChromeDriverManager

# HTMLè¦ç´ ã‚’æ¢ã™ãŸã‚ã®æ–¹æ³•ã‚’æŒ‡å®šã™ã‚‹ã‚¯ãƒ©ã‚¹
from selenium.webdriver.common.by import By

# è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…ã¤ãŸã‚ã®æ©Ÿèƒ½
from selenium.webdriver.support.ui import WebDriverWait

# å¾…æ©Ÿæ¡ä»¶ã‚’æŒ‡å®šã™ã‚‹ã‚¯ãƒ©ã‚¹
from selenium.webdriver.support import expected_conditions as EC

# æ™‚é–“å¾…æ©Ÿç”¨
import time

# ãƒ­ã‚°å‡ºåŠ›ç”¨
import logging

# ãƒ­ã‚°ã®åŸºæœ¬è¨­å®š(æƒ…å ±ãƒ¬ãƒ™ãƒ«ä»¥ä¸Šã‚’è¡¨ç¤ºã€æ™‚åˆ»ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›)
logging.basicConfig(
    level=logging.INFO,  # INFOãƒ¬ãƒ™ãƒ«ä»¥ä¸Šã®ãƒ­ã‚°ã‚’è¡¨ç¤º
    format='%(asctime)s - %(levelname)s - %(message)s'  # ãƒ­ã‚°ã®è¡¨ç¤ºå½¢å¼
)

# ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«å°‚ç”¨ã®ãƒ­ã‚¬ãƒ¼ã‚’ä½œæˆ
logger = logging.getLogger(__name__)


def setup_driver():
    """
    Chromeãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹é–¢æ•°
    Returns: è¨­å®šæ¸ˆã¿ã®webdriverã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
    """
    # Chromeã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ ¼ç´ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
    chrome_options = Options()
    
    # ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰(ç”»é¢ã‚’è¡¨ç¤ºã—ãªã„)ã‚’æœ‰åŠ¹åŒ–
    # ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã™ã‚‹ã¨ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    # chrome_options.add_argument('--headless')
    
    # GPUæ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–(ã‚¨ãƒ©ãƒ¼å›é¿ã®ãŸã‚)
    chrome_options.add_argument('--disable-gpu')
    
    # ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã‚’ç„¡åŠ¹åŒ–(Linuxç’°å¢ƒã§å¿…è¦ãªå ´åˆãŒã‚ã‚‹)
    chrome_options.add_argument('--no-sandbox')
    
    # å…±æœ‰ãƒ¡ãƒ¢ãƒªã®ä½¿ç”¨ã‚’ç„¡åŠ¹åŒ–(Dockerãªã©ã§å¿…è¦)
    chrome_options.add_argument('--disable-dev-shm-usage')
    
    # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã‚’æŒ‡å®š(ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ)
    chrome_options.add_argument('--window-size=1920,1080')
    
    # User-Agentã‚’è¨­å®š(ãƒœãƒƒãƒˆåˆ¤å®šã‚’å›é¿)
    chrome_options.add_argument(
        'user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'
    )
    
    # ç”»åƒã‚’èª­ã¿è¾¼ã¾ãªã„è¨­å®š(é«˜é€ŸåŒ–)â€»å¿…è¦ã«å¿œã˜ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
    # prefs = {'profile.managed_default_content_settings.images': 2}
    # chrome_options.add_experimental_option('prefs', prefs)
    
    # ChromeDriverã‚’è‡ªå‹•ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰&ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    # Service()ã§ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ
    service = Service(ChromeDriverManager().install())
    
    # webdriverã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ(ãƒ–ãƒ©ã‚¦ã‚¶ã‚’èµ·å‹•)
    driver = webdriver.Chrome(
        service=service,  # è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ä½¿ç”¨
        options=chrome_options  # ä¸Šã§è¨­å®šã—ãŸã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é©ç”¨
    )
    
    # æš—é»™çš„ãªå¾…æ©Ÿæ™‚é–“ã‚’10ç§’ã«è¨­å®š(è¦ç´ ãŒè¦‹ã¤ã‹ã‚‹ã¾ã§æœ€å¤§10ç§’å¾…ã¤)
    driver.implicitly_wait(10)
    
    # ãƒ­ã‚°ã«æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›
    logger.info("Chromeãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†")
    
    # è¨­å®šã—ãŸdriverã‚’è¿”ã™
    return driver


def scrape_example(url):
    """
    å®Ÿéš›ã«ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹é–¢æ•°
    Args:
        url: ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã™ã‚‹URL
    """
    # driverå¤‰æ•°ã‚’åˆæœŸåŒ–(ã‚¨ãƒ©ãƒ¼æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ç”¨)
    driver = None
    
    try:
        # ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        driver = setup_driver()
        
        # æŒ‡å®šã•ã‚ŒãŸURLã«ã‚¢ã‚¯ã‚»ã‚¹
        logger.info(f"ã‚¢ã‚¯ã‚»ã‚¹ä¸­: {url}")
        driver.get(url)
        
        # ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ãŒå®Œäº†ã™ã‚‹ã¾ã§2ç§’å¾…æ©Ÿ
        time.sleep(2)
        
        # ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—
        title = driver.title
        logger.info(f"ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«: {title}")
        
        # æ˜ç¤ºçš„ãªå¾…æ©Ÿ: h1è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§æœ€å¤§10ç§’å¾…ã¤
        wait = WebDriverWait(driver, 10)
        h1_element = wait.until(
            EC.presence_of_element_located((By.TAG_NAME, 'h1'))
        )
        
        # h1ã‚¿ã‚°ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
        h1_text = h1_element.text
        logger.info(f"H1ã‚¿ã‚°: {h1_text}")
        
        # è¤‡æ•°ã®è¦ç´ ã‚’å–å¾—ã™ã‚‹ä¾‹(å…¨ã¦ã®ãƒªãƒ³ã‚¯)
        # find_elements: è¤‡æ•°ã®è¦ç´ ã‚’æ¢ã™(ãƒªã‚¹ãƒˆã§è¿”ã‚‹)
        links = driver.find_elements(By.TAG_NAME, 'a')
        logger.info(f"ãƒªãƒ³ã‚¯æ•°: {len(links)}ä»¶")
        
        # æœ€åˆã®5ã¤ã®ãƒªãƒ³ã‚¯ã‚’å‡¦ç†
        for i, link in enumerate(links[:5], 1):
            # hrefå±æ€§ã‚’å–å¾—
            href = link.get_attribute('href')
            # ãƒªãƒ³ã‚¯ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
            link_text = link.text
            # ãƒ­ã‚°ã«å‡ºåŠ›
            logger.info(f"ãƒªãƒ³ã‚¯{i}: {link_text} -> {href}")
        
        # ã‚¯ãƒ©ã‚¹åã§è¦ç´ ã‚’æ¢ã™ä¾‹
        # å­˜åœ¨ã—ãªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
        try:
            # class="content"ã®è¦ç´ ã‚’æ¢ã™
            content = driver.find_element(By.CLASS_NAME, 'content')
            # ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
            content_text = content.text[:100]  # æœ€åˆã®100æ–‡å­—
            logger.info(f"ã‚³ãƒ³ãƒ†ãƒ³ãƒ„: {content_text}...")
        except Exception as e:
            # è¦ç´ ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆ
            logger.warning(f"contentè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {e}")
        
        # CSS Selectorã§è¦ç´ ã‚’æ¢ã™ä¾‹
        try:
            # CSSã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã§æ¤œç´¢
            items = driver.find_elements(By.CSS_SELECTOR, 'div.item')
            logger.info(f"ã‚¢ã‚¤ãƒ†ãƒ æ•°: {len(items)}ä»¶")
            
            # å„ã‚¢ã‚¤ãƒ†ãƒ ã‚’å‡¦ç†
            for i, item in enumerate(items[:3], 1):
                # ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
                item_text = item.text
                logger.info(f"ã‚¢ã‚¤ãƒ†ãƒ {i}: {item_text}")
        except Exception as e:
            logger.warning(f"itemè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {e}")
        
        # XPathã§è¦ç´ ã‚’æ¢ã™ä¾‹
        try:
            # XPathã§æ¤œç´¢(æŸ”è»Ÿãªæ¤œç´¢ãŒå¯èƒ½)
            paragraphs = driver.find_elements(By.XPATH, '//p')
            logger.info(f"æ®µè½æ•°: {len(paragraphs)}ä»¶")
        except Exception as e:
            logger.warning(f"æ®µè½è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {e}")
        
        # ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿å­˜
        driver.save_screenshot('screenshot.png')
        logger.info("ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿å­˜ã—ã¾ã—ãŸ")
        
        # ãƒšãƒ¼ã‚¸ã®HTMLã‚½ãƒ¼ã‚¹å…¨ä½“ã‚’å–å¾—
        page_source = driver.page_source
        logger.info(f"HTMLã‚½ãƒ¼ã‚¹ã®é•·ã•: {len(page_source)}æ–‡å­—")
        
    except Exception as e:
        # ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ
        logger.error(f"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        
        # ã‚¨ãƒ©ãƒ¼æ™‚ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿å­˜
        if driver:
            driver.save_screenshot('error_screenshot.png')
            logger.info("ã‚¨ãƒ©ãƒ¼æ™‚ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿å­˜")
    
    finally:
        # å¿…ãšå®Ÿè¡Œã•ã‚Œã‚‹å‡¦ç†(ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹)
        if driver:
            # ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹
            driver.quit()
            logger.info("ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¾ã—ãŸ")


# ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç›´æ¥å®Ÿè¡Œã•ã‚ŒãŸå ´åˆã®ã¿ä»¥ä¸‹ã‚’å®Ÿè¡Œ
if __name__ == "__main__":
    # ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã™ã‚‹URLã‚’æŒ‡å®š
    target_url = "https://example.com"
    
    # ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å®Ÿè¡Œ
    scrape_example(target_url)
```

## 3. ã‚ˆã‚Šå®Ÿè·µçš„ãªä¾‹ï¼šå‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å–å¾—

```python
# å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time
import logging

# ãƒ­ã‚°è¨­å®š
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(message)s')
logger = logging.getLogger(__name__)


def scrape_dynamic_content():
    """JavaScriptã§èª­ã¿è¾¼ã¾ã‚Œã‚‹å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°"""
    
    # Chromeã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ
    options = Options()
    
    # ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰(ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã™ã‚‹ã¨ç”»é¢è¡¨ç¤ºã•ã‚Œã‚‹)
    # options.add_argument('--headless')
    
    # ãã®ä»–ã®è¨­å®š
    options.add_argument('--disable-gpu')  # GPUç„¡åŠ¹åŒ–
    options.add_argument('--no-sandbox')  # ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ç„¡åŠ¹åŒ–
    
    # ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    service = Service(ChromeDriverManager().install())
    
    # ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’èµ·å‹•
    driver = webdriver.Chrome(service=service, options=options)
    
    try:
        # å¯¾è±¡ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
        logger.info("ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ä¸­...")
        driver.get("https://example.com")
        
        # ç‰¹å®šã®è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…æ©Ÿ(æœ€å¤§15ç§’)
        wait = WebDriverWait(driver, 15)
        
        # id="content"ã®è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…ã¤
        content_element = wait.until(
            EC.presence_of_element_located((By.ID, 'content'))
        )
        logger.info("ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¦ç´ ã‚’ç™ºè¦‹")
        
        # è¦ç´ ãŒã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ãªã‚‹ã¾ã§å¾…ã¤
        button = wait.until(
            EC.element_to_be_clickable((By.ID, 'load-more'))
        )
        
        # ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
        button.click()
        logger.info("ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯")
        
        # ã‚¯ãƒªãƒƒã‚¯å¾Œã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª­ã¿è¾¼ã¿ã‚’å¾…ã¤(3ç§’)
        time.sleep(3)
        
        # å‹•çš„ã«è¿½åŠ ã•ã‚ŒãŸè¦ç´ ã‚’å–å¾—
        new_items = driver.find_elements(By.CLASS_NAME, 'new-item')
        logger.info(f"æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ : {len(new_items)}ä»¶")
        
        # å„ã‚¢ã‚¤ãƒ†ãƒ ã®æƒ…å ±ã‚’æŠ½å‡º
        for i, item in enumerate(new_items, 1):
            # ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
            text = item.text
            # dataå±æ€§ã‚’å–å¾—
            data_id = item.get_attribute('data-id')
            
            logger.info(f"ã‚¢ã‚¤ãƒ†ãƒ {i}: {text} (ID: {data_id})")
        
        # ãƒšãƒ¼ã‚¸ã‚’ä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«(ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯¾å¿œ)
        # ç”»é¢ã®é«˜ã•ã‚’å–å¾—
        last_height = driver.execute_script("return document.body.scrollHeight")
        
        # ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’3å›ç¹°ã‚Šè¿”ã™
        for scroll_count in range(3):
            # ä¸€ç•ªä¸‹ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            driver.execute_script("window.scrollTo(0, document.body.scrollHeight);")
            logger.info(f"ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« {scroll_count + 1}å›ç›®")
            
            # æ–°ã—ã„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã¾ã§å¾…æ©Ÿ
            time.sleep(2)
            
            # æ–°ã—ã„é«˜ã•ã‚’å–å¾—
            new_height = driver.execute_script("return document.body.scrollHeight")
            
            # é«˜ã•ãŒå¤‰ã‚ã‚‰ãªã‘ã‚Œã°çµ‚äº†(ã“ã‚Œä»¥ä¸Šã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒãªã„)
            if new_height == last_height:
                logger.info("ã“ã‚Œä»¥ä¸Šã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã‚ã‚Šã¾ã›ã‚“")
                break
            
            # é«˜ã•ã‚’æ›´æ–°
            last_height = new_height
        
        # å…¨ã¦ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’å†å–å¾—
        all_items = driver.find_elements(By.CLASS_NAME, 'item')
        logger.info(f"åˆè¨ˆã‚¢ã‚¤ãƒ†ãƒ æ•°: {len(all_items)}ä»¶")
        
    except Exception as e:
        # ã‚¨ãƒ©ãƒ¼å‡¦ç†
        logger.error(f"ã‚¨ãƒ©ãƒ¼: {e}")
        
        # ã‚¨ãƒ©ãƒ¼æ™‚ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
        driver.save_screenshot('error.png')
        
    finally:
        # ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹
        driver.quit()
        logger.info("å‡¦ç†å®Œäº†")


# å®Ÿè¡Œ
if __name__ == "__main__":
    scrape_dynamic_content()
```

## 4. ã‚ˆãä½¿ã†Seleniumã®æ“ä½œã¾ã¨ã‚

```python
"""
Seleniumé »å‡ºæ“ä½œãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ
"""

# === è¦ç´ ã®æ¤œç´¢æ–¹æ³• ===

# IDã§æ¤œç´¢
element = driver.find_element(By.ID, 'element-id')

# ã‚¯ãƒ©ã‚¹åã§æ¤œç´¢
element = driver.find_element(By.CLASS_NAME, 'class-name')

# ã‚¿ã‚°åã§æ¤œç´¢
element = driver.find_element(By.TAG_NAME, 'h1')

# CSSã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã§æ¤œç´¢
element = driver.find_element(By.CSS_SELECTOR, 'div.class > p')

# XPathã§æ¤œç´¢
element = driver.find_element(By.XPATH, '//div[@class="example"]')

# ãƒªãƒ³ã‚¯ãƒ†ã‚­ã‚¹ãƒˆã§æ¤œç´¢
element = driver.find_element(By.LINK_TEXT, 'ã‚¯ãƒªãƒƒã‚¯ã¯ã“ã¡ã‚‰')

# éƒ¨åˆ†ä¸€è‡´ã®ãƒªãƒ³ã‚¯ãƒ†ã‚­ã‚¹ãƒˆã§æ¤œç´¢
element = driver.find_element(By.PARTIAL_LINK_TEXT, 'ã“ã¡ã‚‰')

# nameå±æ€§ã§æ¤œç´¢
element = driver.find_element(By.NAME, 'username')


# === è¤‡æ•°è¦ç´ ã®å–å¾— ===

# è¤‡æ•°ã®è¦ç´ ã‚’å–å¾—(ãƒªã‚¹ãƒˆã§è¿”ã‚‹)
elements = driver.find_elements(By.CLASS_NAME, 'item')

# å„è¦ç´ ã‚’å‡¦ç†
for elem in elements:
    print(elem.text)  # ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—


# === è¦ç´ ã®æ“ä½œ ===

# ã‚¯ãƒªãƒƒã‚¯
element.click()

# ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
element.send_keys('å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆ')

# ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¦ã‹ã‚‰å…¥åŠ›
element.clear()  # ã‚¯ãƒªã‚¢
element.send_keys('æ–°ã—ã„ãƒ†ã‚­ã‚¹ãƒˆ')  # å…¥åŠ›

# Enter ã‚­ãƒ¼ã‚’é€ä¿¡
from selenium.webdriver.common.keys import Keys
element.send_keys(Keys.RETURN)


# === è¦ç´ ã®æƒ…å ±å–å¾— ===

# ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
text = element.text

# å±æ€§ã‚’å–å¾—
href = element.get_attribute('href')
class_name = element.get_attribute('class')
data_id = element.get_attribute('data-id')

# CSSãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å–å¾—
color = element.value_of_css_property('color')


# === å¾…æ©Ÿå‡¦ç† ===

# æš—é»™çš„ãªå¾…æ©Ÿ(å…¨ã¦ã®è¦ç´ æ¤œç´¢ã«é©ç”¨)
driver.implicitly_wait(10)  # 10ç§’

# æ˜ç¤ºçš„ãªå¾…æ©Ÿ
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

wait = WebDriverWait(driver, 10)  # æœ€å¤§10ç§’å¾…ã¤

# è¦ç´ ãŒå­˜åœ¨ã™ã‚‹ã¾ã§å¾…ã¤
element = wait.until(
    EC.presence_of_element_located((By.ID, 'element-id'))
)

# è¦ç´ ãŒã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ãªã‚‹ã¾ã§å¾…ã¤
element = wait.until(
    EC.element_to_be_clickable((By.ID, 'button'))
)

# è¦ç´ ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã¾ã§å¾…ã¤
element = wait.until(
    EC.visibility_of_element_located((By.CLASS_NAME, 'content'))
)


# === JavaScriptå®Ÿè¡Œ ===

# JavaScriptã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
driver.execute_script("alert('Hello');")

# ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
driver.execute_script("window.scrollTo(0, 500);")  # 500pxä¸‹ã¸

# ä¸€ç•ªä¸‹ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
driver.execute_script("window.scrollTo(0, document.body.scrollHeight);")

# è¦ç´ ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
element = driver.find_element(By.ID, 'target')
driver.execute_script("arguments[0].scrollIntoView();", element)


# === ãã®ä»–ã®æ“ä½œ ===

# ç¾åœ¨ã®URLã‚’å–å¾—
current_url = driver.current_url

# ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—
title = driver.title

# ãƒšãƒ¼ã‚¸ã‚½ãƒ¼ã‚¹ã‚’å–å¾—
html = driver.page_source

# ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
driver.save_screenshot('screenshot.png')

# ãƒ–ãƒ©ã‚¦ã‚¶ãƒãƒƒã‚¯
driver.back()

# ãƒ–ãƒ©ã‚¦ã‚¶é€²ã‚€
driver.forward()

# ãƒšãƒ¼ã‚¸æ›´æ–°
driver.refresh()
```

## 5. ã¾ã¨ã‚

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
pip install selenium webdriver-manager
```

### æœ€å°æ§‹æˆã‚³ãƒ¼ãƒ‰
```python
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager

# ãƒ‰ãƒ©ã‚¤ãƒãƒ¼èµ·å‹•(è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰)
driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()))

# ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹
driver.get("https://example.com")

# å‡¦ç†...

# çµ‚äº†
driver.quit()
```

**ãƒã‚¤ãƒ³ãƒˆ:**
- âœ… `webdriver-manager`ã§è‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- âœ… æ‰‹å‹•ã§ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’DLä¸è¦
- âœ… ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚‚è‡ªå‹•

ä½•ã‹åˆ†ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚Œã°ã€Pythonå…ˆç”Ÿã«èã„ã¦ãã ã•ã„ã­! ğŸğŸ“š
